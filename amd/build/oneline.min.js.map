{"version":3,"sources":["../src/oneline.js"],"names":["load","icons","each","$container","$menu","find","itemsLength","length","itemSize","outerWidth","scrollDuration","paddleMargin","$leftarrow","left","$rightarrow","right","append","getMenuSize","getMenuPosition","scrollLeft","getMenuWrapperSize","width","hasScroll","get","scrollWidth","clientWidth","getInvisibleSize","menuSize","menuWrapperSize","getMaxScrollLeft","addClass","wrapPadding","getMenuWrapperPadding","menuInvisibleSize","window","on","calcArrowVisible","menuPosition","maxScrollLeft","menuEndOffset","removeClass","event","preventDefault","newX","animate","$active","position"],"mappings":"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","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/*\n * @package   format_onetopic\n * @copyright 2021 David Herney Bernal - cirano\n * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\nimport $ from 'jquery';\n\n/**\n * Load tabs in a single line, with scroll if it is required.\n *\n * @method load\n * @param {object} icons A list of usable icons: left arrow, right arrow.\n */\n export const load = (icons) => {\n\n    $('.onetopic .tabs-wrapper').each(function() {\n\n        var $container = $(this);\n        var $menu = $container.find('> ul.nav.nav-tabs');\n\n        var itemsLength = $menu.find('> li.nav-item').length;\n        var itemSize = $menu.find('> li.nav-item').outerWidth(true);\n\n        // Duration of scroll animation.\n        var scrollDuration = 300;\n\n        // Get some relevant size for the paddle triggering point.\n        var paddleMargin = 20;\n\n        var $leftarrow = $('<button class=\"scroll-arrow left-arrow\">' + icons.left + '</button>');\n        var $rightarrow = $('<button class=\"scroll-arrow right-arrow\">' + icons.right + '</button>');\n\n        $container.append($leftarrow);\n        $container.append($rightarrow);\n\n        // Get total width of all menu items.\n        var getMenuSize = function() {\n            return itemsLength * itemSize;\n        };\n\n        // Get how much have we scrolled to the left.\n        var getMenuPosition = function() {\n            return $menu.scrollLeft();\n        };\n\n        // Get wrapper width.\n        var getMenuWrapperSize = function() {\n            return $container.width();\n        };\n\n        // Get wrapper padding.\n        var getMenuWrapperPadding = function() {\n            return $container.outerWidth() - $container.width();\n        };\n\n        // Check if has scoll.\n        var hasScroll = function() {\n            return $menu.get(0).scrollWidth > $menu.get(0).clientWidth;\n        };\n\n        var getInvisibleSize = function() {\n            return menuSize - getMenuPosition() - menuWrapperSize;\n        };\n\n        var getMaxScrollLeft = function() {\n            return $menu.get(0).scrollWidth - $menu.get(0).clientWidth;// - menuWrapperSize;\n        };\n\n        if (hasScroll()) {\n            $container.addClass('hasscroll');\n        }\n\n        var menuWrapperSize = getMenuWrapperSize();\n        var wrapPadding = getMenuWrapperPadding();\n\n        var menuSize = getMenuSize();\n\n        // Get how much of menu is invisible.\n        var menuInvisibleSize = getInvisibleSize();\n\n        // The wrapper is responsive.\n        $(window).on('resize', function() {\n            menuWrapperSize = getMenuWrapperSize();\n            menuSize = getMenuSize();\n            calcArrowVisible();\n        });\n\n        var calcArrowVisible = function() {\n            // Get how much have we scrolled so far.\n            var menuPosition = getMenuPosition();\n\n            // Get how much of menu is invisible.\n            menuInvisibleSize = getInvisibleSize();\n\n            var maxScrollLeft = getMaxScrollLeft();\n\n            var menuEndOffset = menuInvisibleSize - paddleMargin;\n\n            // Show & hide the paddles depending on scroll position.\n            if (!hasScroll()) {\n                $leftarrow.addClass('hidden');\n                $rightarrow.addClass('hidden');\n                $container.removeClass('hasscroll');\n            } else {\n                $container.addClass('hasscroll');\n                if (menuPosition <= paddleMargin) {\n                    $leftarrow.addClass('hidden');\n                    $rightarrow.removeClass('hidden');\n                } else if (menuPosition < maxScrollLeft) {\n                    // Show both paddles in the middle.\n                    $leftarrow.removeClass('hidden');\n                    $rightarrow.removeClass('hidden');\n                } else if (menuPosition >= menuEndOffset) {\n                    $leftarrow.removeClass('hidden');\n                    $rightarrow.addClass('hidden');\n                }\n            }\n        };\n\n        // Finally, what happens when we are actually scrolling the menu.\n        $menu.on('scroll', function() {\n            calcArrowVisible();\n        });\n\n        // Scroll to left.\n        $rightarrow.on('click', function(event) {\n            event.preventDefault();\n            var newX = getMenuPosition() + (menuWrapperSize * 0.8);\n            $menu.animate({scrollLeft: newX}, scrollDuration);\n        });\n\n        // Scroll to right.\n        $leftarrow.on('click', function(event) {\n            event.preventDefault();\n            var newX = getMenuPosition() - (menuWrapperSize * 0.8);\n            $menu.animate({scrollLeft: newX}, scrollDuration);\n        });\n\n        // Change position to see the active tab.\n        var $active = $container.find('.nav-link.active');\n        if ($active.length > 0) {\n            var newX = $active.position().left - (wrapPadding / 2);\n            $menu.animate({scrollLeft: newX}, scrollDuration);\n        }\n\n        calcArrowVisible();\n    });\n\n};\n"],"file":"oneline.min.js"}