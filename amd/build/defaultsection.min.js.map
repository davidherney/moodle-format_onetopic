{"version":3,"file":"defaultsection.min.js","sources":["../src/defaultsection.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/*\n * @package   format_onetopic\n * @copyright 2021 David Herney Bernal - cirano\n * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\n/**\n * Default section initialization.\n *\n * This will click on tab 1 to reveal its content on loading the page when the following criteria are met:\n * - section 0 is rendered above the tabs\n * - the page is called without a specific section id in the URL\n *\n * @method init\n */\nexport const init = () => {\n    window.console.log('Hausmeister Klaus is in the house!');\n    // Do this only if section 0 is before the tabs and no section is already set in the URL.\n    const generalSection = document.querySelector('.general-section');\n    var currentUrl = new URL(window.location.href);\n    var params = new URLSearchParams(currentUrl.search);\n    if (generalSection && !params.has('section')) {\n        if (params.has('id')) {\n            const idValue = params.get('id');\n            if (idValue) {\n                var link = '';\n                // If a section is marked show this by default.\n                const marked = document.querySelector('.marker .nav-link');\n                if (marked) {\n                    const url = marked.getAttribute('href');\n                    link = url.split('#')[0]; // Keep only the URL w/o any anchors.\n                } else { // Show the 1st section.\n                    link = getBaseURL() + '/course/view.php?id=' + idValue + '&section=1';\n                }\n                window.location.href = link;\n            }\n        }\n    }\n};\n\n/**\n * Get the base URL of the current page.\n */\nfunction getBaseURL() {\n    // Get the protocol\n    var protocol = window.location.protocol;\n    // Get the hostname\n    var hostname = window.location.hostname;\n    // Get the port, if specified\n    var port = window.location.port;\n\n    // Construct the base URL\n    var baseURL = protocol + \"//\" + hostname;\n    if (port) {\n        baseURL += \":\" + port;\n    }\n    return baseURL;\n}\n"],"names":["window","console","log","generalSection","document","querySelector","currentUrl","URL","location","href","params","URLSearchParams","search","has","idValue","get","link","marked","getAttribute","split","protocol","hostname","port","baseURL","getBaseURL"],"mappings":"mKA8BoB,KAChBA,OAAOC,QAAQC,IAAI,4CAEbC,eAAiBC,SAASC,cAAc,wBAC1CC,WAAa,IAAIC,IAAIP,OAAOQ,SAASC,MACrCC,OAAS,IAAIC,gBAAgBL,WAAWM,WACxCT,iBAAmBO,OAAOG,IAAI,YAC1BH,OAAOG,IAAI,MAAO,OACZC,QAAUJ,OAAOK,IAAI,SACvBD,QAAS,KACLE,KAAO,SAELC,OAASb,SAASC,cAAc,wBAClCY,OAAQ,CAERD,KADYC,OAAOC,aAAa,QACrBC,MAAM,KAAK,QAEtBH,oBAaZI,SAAWpB,OAAOQ,SAASY,SAE3BC,SAAWrB,OAAOQ,SAASa,SAE3BC,KAAOtB,OAAOQ,SAASc,KAGvBC,QAAUH,SAAW,KAAOC,SAC5BC,OACAC,SAAW,IAAMD,aAEdC,QAxBgBC,GAAe,uBAAyBV,QAAU,aAE7Dd,OAAOQ,SAASC,KAAOO"}