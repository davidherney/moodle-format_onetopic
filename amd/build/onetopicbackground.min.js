define("format_onetopic/onetopicbackground",["exports","jquery","core/modal_factory","core/modal_save_cancel","core/modal_events"],(function(_exports,_jquery,_modal_factory,_modal_save_cancel,_modal_events){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}
/**
   * Onetopic background selector.
   *
   * @module    format_onetopic/onetopicbackground
   * @copyright 2021 David Herney Bernal - cirano
   * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
   */Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.init=void 0,_jquery=_interopRequireDefault(_jquery),_modal_factory=_interopRequireDefault(_modal_factory),_modal_save_cancel=_interopRequireDefault(_modal_save_cancel),_modal_events=_interopRequireDefault(_modal_events);_exports.init=controlid=>{var $controlinput=(0,_jquery.default)("#"+controlid),$control=$controlinput.parent(".backgroundpicker"),$controlwindow=$control.find(".backgroundpickerwindow"),$controlbutton=$control.find(".backgroundpickerselector"),$colorpickerinput=$controlwindow.find('input.form-control[type="text"]'),title=$controlwindow.attr("title"),buttons=[];buttons.save=$controlwindow.data("savelabel");_modal_factory.default.create({title:title,body:$controlwindow,type:_modal_save_cancel.default.TYPE,large:!0,buttons:buttons}).done((function(modal){modal.getBody().append($controlwindow),$control.data("modal",modal),function(modal){modal.getRoot().on(_modal_events.default.cancel,(()=>{modal.hide()})),modal.getRoot().on(_modal_events.default.save,(()=>{var newcolor=$colorpickerinput.val(),val=$controlinput.val(),color=readColor(val);color?val=val.replace(color,newcolor):""===val.trim()?val=newcolor:val+=" "+newcolor,$controlinput.val(val),modal.hide()}))}(modal)})),$controlbutton.on("click",(function(e){e.preventDefault(),$controlwindow.removeClass("hidden");var currentval=$controlinput.val(),color=readColor(currentval);$colorpickerinput.val(color),$control.data("modal").show()}))};var readColor=function(text){var regexcolor=new RegExp(/#[0-9a-fA-F]{6}/.source+/|#[0-9a-fA-F]{3}/.source+/|rgba?\(\s*([0-9]{1,3}\s*,\s*){2}[0-9]{1,3}\s*(,\s*[0-9.]+\s*)?\)/.source+/|hsla?\(\s*([0-9]{1,3}\s*,\s*){2}[0-9]{1,3}\s*(,\s*[0-9.]+\s*)?\)/.source),color=text.match(regexcolor);return color&&(color=color[0]),color}}));

//# sourceMappingURL=onetopicbackground.min.js.map